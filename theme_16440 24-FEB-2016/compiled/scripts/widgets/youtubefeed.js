define(["modules/jquery-mozu","modules/backbone-mozu","modules/api","modules/modal","hyprlive","hyprlivecontext","widgets/video","vendor/viewport-units-buggyfill","shim!vendor/jquery-fitvids[jquery=jQuery]","//www.youtube.com/iframe_api"],function(e,t,o,r,i,n,a){function d(t){return e.getJSON(u.youtubeFeedURL.replace(l.userName,t))}var u={youtubeFeedURL:"https://gdata.youtube.com/feeds/base/users/__USERNAME__/uploads?v=2&alt=json"},l={userName:/__USERNAME__/gi,videoThumb:/<img.+src="(.+\.jpg)">/i,extraArgs:/&.+/gi},c=t.MozuView.extend({templateName:"widgets/home/youtube-feed-list"}),s=i.getTemplate("modules/modal-video").render({host:window.location.host,returnUrl:window.location.pathname+window.location.search+window.location.hashMozuView}),p=n.locals.themeSettings,m=function(e){var t=this;r.call(t,s),t.$wrapper.appendTo("body"),t.open(),this.$wrapper.find(".mz-modal__inner").append('<div class="mz-product-video-placeholder" data-url="http://www.youtube.com/watch?v='+e+'" data-aspect-ratio="'+p.productPageVideoAspectRatio+'"><div class="mz-product-video-player"></div><div class="mz-product-video-cover"></div></div>'),this.$wrapper.find(".mz-product-video-placeholder").each(a.bindVideo).fitVids()};return require("vendor/viewport-units-buggyfill").init(),m.create=function(e){return new m(e)},e.extend(m.prototype=new r,{constructor:m}),e(document).ready(function(){e("[data-mz-youtubefeed]").each(function(o,r){var i=e(r).data("mzYoutubefeed");i.renderTarget=e("[data-mz-youtubefeed-container]"),e.when(d(i.username)).then(function(o){var r=e.map(o.feed.entry,function(e){return{title:e.title.$t,thumb:e.content.$t.match(l.videoThumb)[1].replace(/default.jpg/,"sddefault.jpg"),url:e.link[0].href.replace(l.extraArgs,"")}});r.length=i.numberToDisplay;var n=new c({el:i.renderTarget,model:new t.Collection(r)});e.when(n.render()).then(function(){e(".mz-home-feedlist__video-link").on("click",function(t){var o=a.parseId(t.currentTarget.href);return 0===e("[id='youtube-player-"+o+"']").length?(m.create(o),!1):void 0})})})})}),m});