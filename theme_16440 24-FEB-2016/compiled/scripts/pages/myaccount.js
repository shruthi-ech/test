define("pages/myaccount",["modules/backbone-mozu","hyprlive","hyprlivecontext","modules/jquery-mozu","underscore","modules/models-customer","modules/views-paging","modules/soft-cart"],function(t,e,i,n,a,d,o,r){var s=t.MozuView.extend({constructor:function(){t.MozuView.apply(this,arguments),this.editing={}},getRenderContext:function(){var e=t.MozuView.prototype.getRenderContext.apply(this,arguments);return e.editing=this.editing,e},doModelAction:function(t,e){var i=this,n=function(){i.render()},a=this.model[t](e);return a&&a.then?(a.then(n,n),a):void 0}}),c=s.extend({templateName:"modules/my-account/my-account-settings",autoUpdate:["firstName","lastName","emailAddress","acceptsMarketing"],constructor:function(){s.apply(this,arguments),this.editing=!1,this.invalidFields={}},initialize:function(){return this.model.getAttributes().then(function(t){return t.get("attributes").each(function(t){t.set("attributeDefinitionId",t.get("id"))}),t})},updateAttribute:function(t){var e=this,i=t.currentTarget.getAttribute("data-mz-attribute"),a=this.model.get("attributes").findWhere({attributeFQN:i}),d="YesNo"===a.get("inputType")?n(t.currentTarget).prop("checked"):n(t.currentTarget).val();a.set("values",[d]),a.validate("values",{valid:function(t,n){e.$('[data-mz-attribute="'+i+'"]').removeClass("is-invalid").next('[data-mz-validationmessage-for="'+n+'"]').text("")},invalid:function(t,n,a){e.$('[data-mz-attribute="'+i+'"]').addClass("is-invalid").next('[data-mz-validationmessage-for="'+n+'"]').text(a)}})},startEdit:function(t){t.preventDefault(),this.editing=!0,this.render()},cancelEdit:function(){this.editing=!1,this.afterEdit()},finishEdit:function(){var t=this;this.doModelAction("apiUpdate").then(function(){t.editing=!1}).otherwise(function(){t.editing=!0}).ensure(function(){t.afterEdit()})},afterEdit:function(){var t=this;t.initialize().ensure(function(){t.render()})}}),u=s.extend({templateName:"modules/my-account/my-account-password",autoUpdate:["oldPassword","password","confirmPassword"],startEditPassword:function(){this.editing.password=!0,this.render()},finishEditPassword:function(){var t=this;this.doModelAction("changePassword").then(function(){a.delay(function(){t.$('[data-mz-validationmessage-for="passwordChanged"]').show().text(e.getLabel("passwordChanged")).fadeOut(3e3)},250)},function(){t.editing.password=!0}),this.editing.password=!1},cancelEditPassword:function(){this.editing.password=!1,this.render()}}),m=s.extend({templateName:"modules/my-account/my-account-wishlist",addItemToCart:function(t){var e=n(t.currentTarget),i=e.data("mzItemId");return i?(this.editing.added=i,this.doModelAction("addItemToCart",i).then(function(){r.update()})):void 0},doNotRemove:function(){this.editing.added=!1,this.editing.remove=!1,this.render()},beginRemoveItem:function(t){var e=n(t.currentTarget).data("mzItemId");e&&(this.editing.remove=e,this.render())},finishRemoveItem:function(t){var e=this,i=n(t.currentTarget).data("mzItemId");if(i){return this.model.apiDeleteItem(i).then(function(){e.editing.remove=!1,n(".mz-wishlist__item-count").text(parseInt(n(".mz-wishlist__item-count").text())-1);var t=parseInt(n(".mz-wishlist__item-count").text());return 1>t&&n(".mz-wishlist__item-count__wrapper").addClass("is-empty"),e.model.apiGet()})}}}),l=t.MozuView.extend({templateName:"modules/my-account/order-history-list",autoUpdate:["rma.returnType","rma.reason","rma.quantity","rma.comments"],initialize:function(){this.listenTo(this.model,"change:pageSize",a.bind(this.model.changePageSize,this.model))},getRenderContext:function(){var e=t.MozuView.prototype.getRenderContext.apply(this,arguments);return e.returning=this.returning,e},startReturnItem:function(t){var e=n(t.currentTarget),i=e.data("mzStartReturn"),a=e.data("mzOrderId");i&&a&&(this.returning=i,this.model.startReturn(a,i)),this.render()},cancelReturnItem:function(){delete this.returning,this.model.clearReturn(),this.render()},finishReturnItem:function(){var t=this,e=this.model.finishReturn();return e?e.then(function(){delete t.returning,t.render()}):void 0}}),g=t.MozuView.extend({templateName:"modules/my-account/return-history-list",initialize:function(){var t=this;this.listenTo(this.model,"change:pageSize",a.bind(this.model.changePageSize,this.model)),this.listenTo(this.model,"returndisplayed",function(e){var i=t.$('[data-mz-id="'+e+'"]');0===i.length&&(i=t.$el),i.ScrollTo({axis:"y"})})}}),h=s.extend({templateName:"modules/my-account/my-account-paymentmethods",autoUpdate:["editingCard.paymentOrCardType","editingCard.nameOnCard","editingCard.cardNumberPartOrMask","editingCard.expireMonth","editingCard.expireYear","editingCard.cvv","editingCard.isCvvOptional","editingCard.contactId","editingContact.firstName","editingContact.lastNameOrSurname","editingContact.address.address1","editingContact.address.address2","editingContact.address.address3","editingContact.address.cityOrTown","editingContact.address.countryCode","editingContact.address.stateOrProvince","editingContact.address.postalOrZipCode","editingContact.address.addressType","editingContact.phoneNumbers.home","editingContact.isBillingContact","editingContact.isPrimaryBillingContact","editingContact.isShippingContact","editingContact.isPrimaryShippingContact"],renderOnChange:["editingCard.contactId","editingContact.address.countryCode"],beginEditCard:function(t){var e=this.editing.card=t.currentTarget.getAttribute("data-mz-card");this.model.beginEditCard(e),this.render()},finishEditCard:function(){var t=this,e=this.doModelAction("saveCard");e&&(e.otherwise(function(){t.editing.card=!0}),this.editing.card=!1)},cancelEditCard:function(){this.editing.card=!1,this.model.endEditCard(),this.render()},beginDeleteCard:function(t){var i=t.currentTarget.getAttribute("data-mz-card"),n=this.model.get("cards").get(i);window.confirm(e.getLabel("confirmDeleteCard",n.get("cardNumberPart")))&&this.doModelAction("deleteCard",i)}}),C=s.extend({templateName:"modules/my-account/my-account-addressbook",autoUpdate:["editingContact.firstName","editingContact.lastNameOrSurname","editingContact.address.address1","editingContact.address.address2","editingContact.address.address3","editingContact.address.cityOrTown","editingContact.address.countryCode","editingContact.address.stateOrProvince","editingContact.address.postalOrZipCode","editingContact.address.addressType","editingContact.phoneNumbers.home","editingContact.isBillingContact","editingContact.isPrimaryBillingContact","editingContact.isShippingContact","editingContact.isPrimaryShippingContact"],renderOnChange:["editingContact.address.countryCode","editingContact.isBillingContact","editingContact.isShippingContact"],beginAddContact:function(){this.editing.contact="new",this.render()},beginEditContact:function(t){var e=this.editing.contact=t.currentTarget.getAttribute("data-mz-contact");this.model.beginEditContact(e),this.render()},finishEditContact:function(){var t=this,e=i.locals.siteContext.generalSettings.isAddressValidationEnabled,n=this.doModelAction("saveContact",{forceIsValid:e});n&&(n.otherwise(function(){t.editing.contact=!0}),this.editing.contact=!1)},cancelEditContact:function(){this.editing.contact=!1,this.model.endEditContact(),this.render()},beginDeleteContact:function(t){var i=this,n=this.model.get("contacts").get(t.currentTarget.getAttribute("data-mz-contact")),d=this.model.get("cards").where({contactId:n.id}),o=e.getLabel("confirmDeleteContact",n.get("address").get("address1")),r=function(){return i.doModelAction("deleteContact",n.id)},s=r;return d.length>0&&(o+=" "+e.getLabel("confirmDeleteContact2"),s=function(){return i.doModelAction("deleteMultipleCards",a.pluck(d,"id")).then(r)}),window.confirm(o)?s():void 0}}),f=t.MozuView.extend({templateName:"modules/my-account/my-account-storecredit",addStoreCredit:function(){var t=this,e=this.$("[data-mz-entering-credit]").val();return e?this.model.addStoreCredit(e).then(function(){return t.model.getStoreCredits()}):void 0}});n(document).ready(function(){var t=window.accountModel=d.EditableCustomer.fromCurrent(),e=n("#account-settings"),r=n("#password-section"),s=n("#account-orderhistory"),p=n("#account-returnhistory"),y=n("#account-paymentmethods"),w=n("#account-addressbook"),v=n("#account-wishlist"),b=n("#account-messages"),z=n("#account-storecredit"),x=t.get("orderHistory"),E=t.get("returnHistory"),N=window.accountViews={settings:new c({el:e,model:t,messagesEl:b}),password:new u({el:r,model:t,messagesEl:b}),orderHistory:new l({el:s.find("[data-mz-orderlist]"),model:x}),orderHistoryPagingControls:new o.PagingControls({templateName:"modules/my-account/order-history-paging-controls",el:s.find("[data-mz-pagingcontrols]"),model:x}),orderHistoryPageNumbers:new o.PageNumbers({el:s.find("[data-mz-pagenumbers]"),model:x}),returnHistory:new g({el:p.find("[data-mz-orderlist]"),model:E}),returnHistoryPagingControls:new o.PagingControls({templateName:"modules/my-account/order-history-paging-controls",el:p.find("[data-mz-pagingcontrols]"),model:E}),returnHistoryPageNumbers:new o.PageNumbers({el:p.find("[data-mz-pagenumbers]"),model:E}),paymentMethods:new h({el:y,model:t,messagesEl:b}),addressBook:new C({el:w,model:t,messagesEl:b}),storeCredit:new f({el:z,model:t,messagesEl:b})};i.locals.siteContext.generalSettings.isWishlistCreationEnabled&&(N.wishList=new m({el:v,model:t.get("wishlist"),messagesEl:b})),a.invoke(window.accountViews,"render")})}),require(["modules/jquery-mozu","modules/backbone-mozu","modules/views-paging","modules/is-mobile","shim!vendor/bootstrap/js/affix[jquery=jQuery]"],function(t,e,i,n){t(document).ready(function(){n||setTimeout(function(){t("#account-nav").affix({offset:{top:10,bottom:900}})},500),e.MozuView.on("render",function(t){t instanceof i.PagingControls||t instanceof i.PageNumbers})})}),define("modules/myaccount-scrollfix",function(){});